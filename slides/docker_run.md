# Команда `docker run`

## Основные концепции

Простая команда:
<pre>
docker run hello-world:latest
</pre>

Docker-демон выполняет следующие шаги:
* скачивает образ из registry (в нашем случае docker-hub)
    * проверяет наличие образа на локальной машине - если есть, то использует его для создания контейнера
    * скачивает образ с Docker Hub, если отсутствует локально
* создает контейнер
    * инициализирует файловую систему и монтирует read-only уровень
    * инициализирует сеть/мост
        * создает сетевой интерфейс, который позволяет docker-у общаться хост машиной (и разным контейнерам друг с другом)
        * устанавливает IP адрес контейнера
* запускает указанный процесс в контейнере
* подключается в контейнер и логирует stdin, stdout, stderr в докер-клиент

Docker представляет огромное количество команд для интроспекции, и первая из таких команд - команда `ls`, которая позволяет проверить список доступных контейнеров
<pre>
docker container ls -a
</pre>

Результат работы команды - контейнеры, доступные в системе, в т.ч. контейнер `hello-world`, который вы только что запустили
<pre>
CONTAINER ID        IMAGE                COMMAND                  CREATED             STATUS                      PORTS                    NAMES
3fe7c1a64157        hello-world:latest   "/hello"                 27 seconds ago      Exited (0) 26 seconds ago                            compassionate_buck
</pre>

Команда `docker run` умеет принимать огромное количество аргументов, которые параметризуют запуск контейнера - давайте узнаем, как именно.

## Параметры команды `docker run`

Рассмотрим команду на примере контейнера с Postgres.

Запустить контейнер с сервисом Postgres командой 

<pre>
docker run --name pg-server -d postgres:10-alpine
</pre>

Проверим, что контейнер успешно поднялся с помощью утилиты `docker ps`, в консоли должны увидеть сообщение о том, что контейнер запущен:
<pre>
CONTAINER ID        IMAGE                COMMAND                  CREATED             STATUS              PORTS                      NAMES
da1f19e29dcd        postgres:10-alpine   "docker-entrypoint.s…"   7 seconds ago       Up 5 seconds        5432/tcp                   pg-server
</pre>

Мы использовали следующие параметры

* `--name` чтобы дать осмысленное имя запускаемому контейнеру
* `--detach` чтобы не засорять stdout вашей хост-системы логами контейнера

Чтобы остановить или удалить контейнер, скопируйте `CONTAINER ID` из первого столбца таблицы.

Для остановки контейнера выполните команду `docker container stop da1f19e29dcd`. Проверьте, что контейнер погас с помощью `docker ps`.

Для запуска контейнера выполните команду `docker container start da1f19e29dcd`. Проверьте, что контейнер ожил с помощью `docker ps`.

Для удаления контейнера выполните команду `docker rm -f da1f19e29dcd`. Проверьте, помощью `docker start`, что контейнер перестал работать.

У команды `docker run` огромное количество параметров, с которыми [можно познакомиться в документации](https://docs.docker.com/engine/reference/run/).

Всё, что нужно знать о `docker run` - это способ запустить **готовый** образ - точно так же, как вы запускаете программу - и передать в контейнер некоторые параметры.

**Вопрос на внимательность**: чем отличается `docker run` от `docker start`?

Кроме `run` и `start` есть ещё команда `docker attach`, которая позволяет подключиться к уже запущенному внутри контейнера процессу вместо того, чтобы запускать новый.

О том, какие именно параметры позволяют гибко конфигурировать контейнеры, мы узнаем сразу после знакомства с командой [docker network](./docker_network.md)